import{g as x,h as w,i as S,u as g,r as m,k as P,m as U,j as e,L as C,I as y,n as V,o as q,p as _,B as M,q as F,t as I,v as R,M as L,w as T}from"./index-CTbu2FOC.js";import{N as E}from"./NoticeCard-0FT9enpf.js";import{U as $}from"./UploadFotoForm-CiVWEpig.js";import{u as A}from"./index.esm-B5nzorOR.js";import{c as B,a as b,o as G}from"./index.esm-H8jkYDyc.js";import"./formatDate-Cl6MRW5r.js";const Y=()=>{const s=x(w).favorites,l=x(S),n=1e3,i=g();return m.useEffect(()=>(i(P({page:1,limit:n,title:null,category:null,sex:null,species:null,sort:null})),()=>{i(U())}),[i]),e.jsx("div",{className:"favorites-wrap",children:s.length!==0?l==null?void 0:l.filter(a=>s.includes(a._id)).map(a=>e.jsx(E,{data:a},a._id)):e.jsx("div",{className:"favorites-no-pets",children:e.jsxs("p",{children:["Oops, ",e.jsx("span",{children:"looks like there aren't any furries"})," on our adorable page yet. Do not worry! View your pets on the"," ",e.jsx(C,{to:"/notices",className:"favorites-link",children:'"find your favorite pet"'})," ","page and add them to your favorites."]})})})},z=({data:t})=>{const{sex:s,imgURL:l,title:n,name:i,birthday:a,species:r,_id:o}=t,p=g(),h=()=>{o&&p(V(o))};return e.jsxs("div",{className:"my-pet-border",children:[e.jsxs("div",{className:"my-pet-wrapper",children:[l?e.jsx("img",{src:l.toString(),alt:n,className:"my-pet-img"}):e.jsx(y,{className:"icon-paw",name:"icon-paw"}),e.jsxs("div",{children:[e.jsx("h3",{className:"my-pet-title",title:n,children:n}),e.jsxs("div",{className:"my-pet-text-wrapper",children:[e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Name"}),e.jsx("p",{className:"my-pet-notices-text",title:i,children:i})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Birthday"}),e.jsx("p",{children:a})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Sex"}),e.jsx("p",{children:s})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Species"}),e.jsx("p",{children:r})]})]})]})]}),e.jsx("div",{className:"my-pet-delete",onClick:h,children:e.jsx(y,{className:"icon-heart delete",name:"delete"})})]})},H=()=>{const t=x(q);return e.jsx("section",{className:"my-pets-list",children:(t==null?void 0:t.length)!==0?t.map(s=>e.jsx(z,{data:s},s._id)):e.jsx("p",{className:"favorites-no-pets",children:"No my pets yet :("})})},J=({onClose:t,userData:s})=>{var c,v,f;const l=g(),n=B({name:b(),email:b().email(),phone:b().matches(/^\d+$/,"The phone must contain only numbers.").length(9,"The phone must contain exactly 9 digits")}).required(),{register:i,handleSubmit:a,setValue:r,watch:o,reset:p,formState:{errors:h}}=A({resolver:G(n),defaultValues:{name:s.name||"User name",email:s.email||"",phone:((c=s.phone)==null?void 0:c.toString())||""},mode:"onBlur"});m.useEffect(()=>{var d;r("name",s.name||"User name"),r("phone",((d=s.phone)==null?void 0:d.toString())||"")},[s,r]);const j=async d=>{const N={name:d.name,phone:d.phone};try{await l(_(N)),p(N),t(),M.success("Your data is successfully updated")}catch{M.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:a(j),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...i("name"),className:"input edit",value:o("name"),onChange:d=>r("name",d.target.value)}),e.jsx("p",{className:"form-errors",children:(v=h.name)==null?void 0:v.message})]}),e.jsx("div",{children:e.jsx("input",{...i("email"),className:"input edit",value:o("email"),readOnly:!0})}),e.jsxs("div",{children:[e.jsx("input",{...i("phone"),className:"input edit",value:o("phone"),onChange:d=>r("phone",d.target.value)}),e.jsx("p",{className:"form-errors",children:(f=h.phone)==null?void 0:f.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},K=m.forwardRef(({userData:t,onClose:s,onChange:l},n)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:t.avatar?t.avatar:F,alt:t.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx($,{onChange:l,ref:n,isModal:!0})}),e.jsx(J,{onClose:s,userData:t})]})),Q=()=>{const t=x(w),{name:s,email:l,phone:n}=t,a=(r=>{const o=r==null?void 0:r.toString();if(o)return o==null?void 0:o.replace(/(\d{2})(\d{3})(\d{2})(\d{2})/,"$1 $2 $3 $4")})(n);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:s||"User name",className:"input profile",readOnly:!0}),e.jsx("input",{type:"email",value:l??"email",className:"input profile",readOnly:!0}),e.jsx("input",{type:"tel",value:`+380 ${a}`,className:"input profile",readOnly:!0})]})]})},W=()=>{const s=x(w).viewed,l=x(S),n=1e3,i=g();return m.useEffect(()=>(i(P({page:1,limit:n,title:null,category:null,sex:null,species:null,sort:null})),()=>{i(U())}),[i]),e.jsx("div",{className:"favorites-wrap",children:s.length!==0?l==null?void 0:l.filter(a=>s.includes(a._id)).map(a=>e.jsx(E,{data:a},a._id)):e.jsx("div",{className:"favorites-no-pets",children:e.jsxs("p",{children:["Oops, ",e.jsx("span",{children:"looks like there aren't any viewed furries"})," on our adorable page yet. Do not worry! View your pets on the"," ",e.jsx(C,{to:"/notices",className:"favorites-link",children:'"find your favorite pet"'})," ","page and add them to your favorites."]})})})},te=()=>{const[t,s]=m.useState(!1),[l,n]=m.useState(!1),[i,a]=m.useState(),[r,o]=m.useState(!0),[p,h]=m.useState(!1),j=m.useRef(null),c=x(w),v=g(),f=u=>{u==="open"?(n(!0),document.body.classList.add("body-scroll-lock")):(n(!1),document.body.classList.remove("body-scroll-lock"))},d=u=>{u==="open"?(s(!0),document.body.classList.add("body-scroll-lock")):(s(!1),document.body.classList.remove("body-scroll-lock"))},N=u=>{if(u instanceof File)a(u);else{const k=u.target.files;if(k&&k.length>0){const O=k[0];a(O)}}};return m.useEffect(()=>{i&&(v(I(i)),j.current&&(j.current.value=""))},[i,v]),e.jsxs("div",{children:[!c&&e.jsx(R,{}),c&&e.jsxs("div",{className:"profile-main-wrap",children:[e.jsxs("div",{className:"profile-background my",children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap name",children:[e.jsx("p",{className:"profile-name",children:c.name}),e.jsx(y,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>f("open"),children:e.jsx(y,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:c!=null&&c.avatar?`${c.avatar}`:F,alt:c.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx($,{onChange:N,ref:j,isModal:!1})}),e.jsx(Q,{}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs(C,{to:"/add-pet",className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(y,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(H,{}),e.jsx("button",{type:"button",onClick:u=>{u.stopPropagation(),d("open")},className:"menu-link register",children:e.jsx("p",{className:"menu-logout",children:"Log out"})})]}),e.jsxs("div",{className:"profile-right-part",children:[e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${r&&!p||!r&&!p?"":"unactive"}`,onClick:()=>{o(!0),h(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${p&&!r?"":"unactive"}`,onClick:()=>{h(!0),o(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background favorite",children:[r&&!p&&e.jsx(Y,{}),p&&!r&&e.jsx(W,{})]})]}),t&&e.jsx(L,{onClose:()=>d("close"),children:e.jsx(T,{userData:c,onClose:()=>d("close")})}),l&&e.jsx(L,{onClose:()=>f("close"),children:e.jsx(K,{userData:c,onClose:()=>f("close"),onChange:N})})]})]})};export{te as default};
