import{u as w,i as j,k as b,m as M,a as k,r as p,n as U,o as E,j as e,L as P,I as g,p as q,q as S,t as R,v as I,w as A,B as F,x as O,y as B,z,M as L,A as G}from"./index-1Xy9gwCk.js";import{N as V}from"./NoticeCard-BSTt4Azq.js";import{U as T}from"./UploadFotoForm-DgTSA8ka.js";import{u as Y}from"./index.esm-DP1coSMj.js";import{c as H,a as $,o as J}from"./index.esm-C0-6vTTF.js";import"./formatDate-Cl6MRW5r.js";const K=()=>{const{theme:t}=w(),n=j(b).favorites,r=j(M),o=1e3,l=k();return p.useEffect(()=>(l(U({page:1,limit:o,title:null,category:null,sex:null,species:null,sort:null})),()=>{l(E())}),[l]),e.jsx("div",{className:"favorites-wrap",children:n.length!==0?r==null?void 0:r.filter(i=>n.includes(i._id)).map(i=>e.jsx(V,{data:i},i._id)):e.jsx("div",{className:`favorites-no-pets ${t==="light"?"":"dark"}`,children:e.jsxs("p",{children:["Oops, ",e.jsx("span",{children:"looks like there aren't any furries"})," on our adorable page yet. Do not worry! View your pets on the"," ",e.jsx(P,{to:"/notices",className:"favorites-link",children:'"find your favorite pet"'})," ","page and add them to your favorites."]})})})},Q=({data:t})=>{const{sex:a,imgURL:n,title:r,name:o,birthday:l,species:i,_id:s}=t,[c,h]=p.useState(!1),f=j(M),u=k(),d=()=>{s&&(u(q(s)),u(S(s)))},v=()=>{c||(s&&u(R(s)),h(!0))},x=()=>{c&&(s&&u(S(s)),h(!1))};return p.useEffect(()=>{if(s){const m=f.find(N=>N._id===s);h(!!m)}},[f,s]),e.jsxs("div",{className:"my-pet-border",children:[e.jsxs("div",{className:"my-pet-wrapper",children:[n?e.jsx("img",{src:n.toString(),alt:r,className:"my-pet-img"}):e.jsx(g,{className:"icon-paw",name:"icon-paw"}),e.jsxs("div",{className:"my-pet-middle-part",children:[e.jsx("h3",{className:"my-pet-title",title:r,children:r}),e.jsxs("div",{className:"my-pet-text-wrapper",children:[e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Name"}),e.jsx("p",{className:"my-pet-notices-text",title:o,children:o})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Birthday"}),e.jsx("p",{children:l})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Sex"}),e.jsx("p",{children:a})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Species"}),e.jsx("p",{children:i})]})]})]})]}),e.jsx("div",{className:"my-pet-delete",onClick:d,children:e.jsx(g,{className:"icon-heart delete",name:"delete"})}),e.jsxs("div",{className:"my-pet-button-wrapper",children:[e.jsx("button",{type:"button",onClick:v,className:"form-button submit to-publish",children:c?e.jsxs(e.Fragment,{children:["Published ",e.jsx(g,{name:"icon-check",className:"icon-check"})]}):"To publish"}),e.jsx("button",{type:"button",onClick:x,className:"form-button back remove",children:"Remove from publication"})]})]})},W=()=>{const t=j(I);return e.jsx("section",{className:"my-pets-list",children:(t==null?void 0:t.length)!==0?t.map(a=>e.jsx(Q,{data:a},a._id)):e.jsx("p",{className:"favorites-no-pets my-pets",children:"No my pets yet :("})})},X=({onClose:t,userData:a})=>{var d,v,x;const n=k(),r=H({name:$(),email:$().email(),phone:$().matches(/^\d+$/,"The phone must contain only numbers.").length(9,"The phone must contain exactly 9 digits")}).required(),{theme:o}=w(),{register:l,handleSubmit:i,setValue:s,watch:c,reset:h,formState:{errors:f}}=Y({resolver:J(r),defaultValues:{name:a.name||"User name",email:a.email||"",phone:((d=a.phone)==null?void 0:d.toString())||""},mode:"onBlur"});p.useEffect(()=>{var m;s("name",a.name||"User name"),s("phone",((m=a.phone)==null?void 0:m.toString())||"")},[a,s]);const u=async m=>{const N={name:m.name,phone:m.phone};try{await n(A(N)),h(N),t(),F.success("Your data is successfully updated")}catch{F.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:i(u),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...l("name"),className:`input ${o==="light"?"":"dark"} edit`,value:c("name"),onChange:m=>s("name",m.target.value)}),e.jsx("p",{className:"form-errors",children:(v=f.name)==null?void 0:v.message})]}),e.jsx("div",{children:e.jsx("input",{...l("email"),className:`input ${o==="light"?"":"dark"} edit`,value:c("email"),readOnly:!0})}),e.jsxs("div",{className:"input-wrap-number",children:[e.jsx("input",{...l("phone"),className:`input ${o==="light"?"":"dark"} edit`,value:c("phone"),onChange:m=>s("phone",m.target.value)}),e.jsx("p",{className:"form-number-default",children:"+380"}),e.jsx("p",{className:"form-errors",children:(x=f.phone)==null?void 0:x.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},Z=p.forwardRef(({userData:t,onClose:a,onChange:n},r)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:t.avatar?t.avatar:O,alt:t.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx(T,{onChange:n,ref:r,isModal:!0})}),e.jsx(X,{onClose:a,userData:t})]})),D=()=>{const t=j(b),{theme:a}=w(),{name:n,email:r,phone:o}=t,i=o?(s=>{const c=s==null?void 0:s.toString();if(c)return c==null?void 0:c.replace(/(\d{2})(\d{3})(\d{2})(\d{2})/,"$1 $2 $3 $4")})(o):"";return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:n||"User name",className:`input profile ${a==="light"?"":"dark"}`,readOnly:!0}),e.jsx("input",{type:"email",value:r??"email",className:`input profile ${a==="light"?"":"dark"}`,readOnly:!0}),e.jsx("input",{type:"tel",value:`+380 ${i}`,className:`input profile ${a==="light"?"":"dark"}`,readOnly:!0})]})]})},ee=()=>{const{theme:t}=w(),n=j(b).viewed,r=j(M),o=1e3,l=k();return p.useEffect(()=>(l(U({page:1,limit:o,title:null,category:null,sex:null,species:null,sort:null})),()=>{l(E())}),[l]),e.jsx("div",{className:"favorites-wrap",children:n.length!==0?r==null?void 0:r.filter(i=>n.includes(i._id)).map(i=>e.jsx(V,{data:i},i._id)):e.jsx("div",{className:`favorites-no-pets ${t==="light"?"":"dark"}`,children:e.jsxs("p",{children:["Oops, ",e.jsx("span",{children:"looks like there aren't any viewed furries"})," on our adorable page yet. Do not worry! View your pets on the"," ",e.jsx(P,{to:"/notices",className:"favorites-link",children:'"find your favorite pet"'})," ","page and add them to your favorites."]})})})},ne=()=>{const{theme:t}=w(),[a,n]=p.useState(!1),[r,o]=p.useState(!1),[l,i]=p.useState(),[s,c]=p.useState(!0),[h,f]=p.useState(!1),u=p.useRef(null),d=j(b),v=k(),x=y=>{y==="open"?(o(!0),document.body.classList.add("body-scroll-lock")):(o(!1),document.body.classList.remove("body-scroll-lock"))},m=y=>{n(!1),document.body.classList.remove("body-scroll-lock")},N=y=>{if(y instanceof File)i(y);else{const C=y.target.files;if(C&&C.length>0){const _=C[0];i(_)}}};return p.useEffect(()=>{l&&(v(B(l)),u.current&&(u.current.value=""))},[l,v]),e.jsxs("div",{children:[!d&&e.jsx(z,{}),d&&e.jsxs("div",{className:"profile-main-wrap",children:[e.jsxs("div",{className:`profile-background my ${t==="light"?"":"dark"}`,children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap name",children:[e.jsx("p",{className:"profile-name",children:d.name}),e.jsx(g,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>x("open"),children:e.jsx(g,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:d!=null&&d.avatar?`${d.avatar}`:O,alt:d.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx(T,{onChange:N,ref:u,isModal:!1})}),e.jsx(D,{}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs(P,{to:"/add-pet",className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(g,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(W,{})]}),e.jsxs("div",{className:"profile-right-part",children:[e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${s&&!h||!s&&!h?"":"unactive"} ${t==="light"?"":"dark"}`,onClick:()=>{c(!0),f(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${h&&!s?"":"unactive"} ${t==="light"?"":"dark"}`,onClick:()=>{f(!0),c(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background favorite",children:[s&&!h&&e.jsx(K,{}),h&&!s&&e.jsx(ee,{})]})]}),a&&e.jsx(L,{onClose:()=>m(),children:e.jsx(G,{userData:d,onClose:()=>m()})}),r&&e.jsx(L,{onClose:()=>x("close"),children:e.jsx(Z,{userData:d,onClose:()=>x("close"),onChange:N})})]})]})};export{ne as default};
