import{e as g,s as F,f as E,u as y,r as n,g as P,j as e,h as O,B as b,i as M,k as $,I as N,M as C,m as U,n as V}from"./index-BPEaGLbf.js";import{N as A}from"./NoticeCard-DkHybTMY.js";import{u as q}from"./index.esm-CXwDtSdY.js";import{c as I,a as k,d as R,o as T}from"./index.esm-Cz3PDvGG.js";import"./formatDate-Cl6MRW5r.js";const _=()=>{const s=g(F).favorites,r=g(E),t=6,c=y();return n.useEffect(()=>{c(P({page:1,limit:t,title:null,category:null,sex:null,species:null,sort:null}))},[c]),e.jsx("div",{className:"favorites-wrap",children:s.length!==0?r==null?void 0:r.filter(m=>s.includes(m._id)).map(m=>e.jsx(A,{data:m},m._id)):e.jsx("p",{className:"favorites-no-pets",children:"No favorite pets yet :("})})},B=()=>e.jsx("section",{className:"my-pets-list",children:e.jsx("p",{className:"favorites-no-pets",children:"No my pets yet :("})}),L=n.forwardRef(({onChange:a},s)=>{const r=t=>{a(t)};return e.jsxs("form",{onSubmit:t=>t.preventDefault(),children:[e.jsx("input",{id:"inputFile",type:"file",onChange:r,className:"inputFile",ref:s}),e.jsx("label",{htmlFor:"inputFile",className:"uploadPhoto",children:e.jsx("p",{className:"profile-upload",children:"Upload photo"})})]})}),G=({onClose:a,userData:s})=>{var j,l,h;const r=y(),t=I({name:k(),email:k().email().required("Email is required"),phone:R()}).required(),{register:c,handleSubmit:m,setValue:o,watch:u,formState:{errors:d}}=q({resolver:T(t),defaultValues:{name:s.name||"",email:s.email||"",phone:s.phone||0}});n.useEffect(()=>{o("name",s.name||""),o("email",s.email||""),o("phone",s.phone||0)},[s,o]);const x=async i=>{try{if(await r(O(i)),a(),d)return b.error("Something went wrong...")}catch{b.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:m(x),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...c("name"),className:"input",value:u("name"),onChange:i=>o("name",i.target.value)}),e.jsx("p",{className:"form-errors",children:(j=d.name)==null?void 0:j.message})]}),e.jsxs("div",{children:[e.jsx("input",{...c("email"),className:"input",value:u("email"),onChange:i=>o("email",i.target.value)}),e.jsx("p",{className:"form-errors",children:(l=d.email)==null?void 0:l.message})]}),e.jsxs("div",{children:[e.jsx("input",{...c("phone"),className:"input",value:u("phone"),onChange:i=>o("phone",Number(i.target.value))}),e.jsx("p",{className:"form-errors",children:(h=d.phone)==null?void 0:h.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},W=n.forwardRef(({userData:a,onClose:s,onChange:r},t)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:a.avatar?a.avatar.startsWith("http")?a.avatar:`undefined${a.avatar}`:M,alt:a.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(L,{onChange:r,ref:t})]}),e.jsx(G,{onClose:s,userData:a})]})),z=({userData:a})=>{const{name:s,email:r,phone:t}=a;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:s??"NONAME",className:"input profile",readOnly:!0}),e.jsx("input",{type:"email",value:r??"email",className:"input profile",readOnly:!0}),e.jsx("input",{type:"tel",value:t??"+380",className:"input profile",readOnly:!0})]})]})},H=()=>e.jsx("div",{children:"ViewedList"}),Z=()=>{const[a,s]=n.useState(!1),[r,t]=n.useState(!1),[c,m]=n.useState(),[o,u]=n.useState(!0),[d,x]=n.useState(!1),j=n.useRef(null),l=g(F),h=y(),i=p=>{p==="open"?(t(!0),document.body.classList.add("body-scroll-lock")):(t(!1),document.body.classList.remove("body-scroll-lock"))},v=p=>{p==="open"?(s(!0),document.body.classList.add("body-scroll-lock")):(s(!1),document.body.classList.remove("body-scroll-lock"))},w=p=>{const f=p.target.files;if(f&&f.length>0){const S=f[0];m(S)}};return n.useEffect(()=>{(async()=>{if(c)try{await h(V(c))}catch(f){console.error("Failed to update avatar:",f)}})()},[c,h]),e.jsxs("div",{children:[!l&&e.jsx($,{}),l&&e.jsxs("div",{className:"profile-main-wrap",children:[e.jsxs("div",{className:"profile-background my",children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:l.name}),e.jsx(N,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>i("open"),children:e.jsx(N,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:l!=null&&l.avatar?`${l.avatar}`:M,alt:l.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(L,{onChange:w,ref:j})]}),e.jsx(z,{userData:l}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs("div",{className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(N,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(B,{}),e.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),v("open")},className:"menu-link register",children:e.jsx("p",{className:"menu-logout",children:"Log out"})})]}),e.jsxs("div",{className:"profile-right-part",children:[e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${o&&!d||!o&&!d?"":"unactive"}`,onClick:()=>{u(!0),x(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${d&&!o?"":"unactive"}`,onClick:()=>{x(!0),u(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background",children:[o&&!d&&e.jsx(_,{}),d&&!o&&e.jsx(H,{})]})]}),a&&e.jsx(C,{onClose:()=>v("close"),children:e.jsx(U,{userData:l,onClose:()=>v("close")})}),r&&e.jsx(C,{onClose:()=>i("close"),children:e.jsx(W,{userData:l,onClose:()=>i("close"),onChange:w})})]})]})};export{Z as default};
