import{u as b,j as s,I as q,a as J,r as n,D as F,J as V,i as U,m as _,K as z,o as H,n as W}from"./index-BCr9U-Qp.js";import{F as X,P as Y}from"./FindForm-DbAPFApP.js";import{N as Z}from"./NoticeCard-BRcubh-D.js";import{u as A,C as Q}from"./index.esm-DVYq0J_M.js";import{c as ee,a as P,o as se}from"./index.esm-CkFuUXGX.js";import{M as v,t as te}from"./types-DF6m-7pv.js";import"./index-BigFSjfC.js";import"./formatDate-Cl6MRW5r.js";const ae=({setSearchQuery:t,text:g,isActive:a,onClick:i})=>{const r=()=>{t(e=>({...e,sort:a?"":g})),i()},{theme:d}=b();return s.jsx("div",{className:"button-wrap",children:s.jsxs("button",{type:"submit",className:`sort-button ${d==="light"?"":"dark"} ${a?"cross":""}`,onClick:r,children:[g,a&&s.jsx(q,{className:"icon-cross",name:"close"})]})})},ne=["unknown","female","male","multiple"],oe=["sell","free","lost","found"],w=({placeholder:t,setSearchQuery:g})=>{const a=ee({category:P(),sex:P(),species:P()}).required(),{theme:i}=b(),{handleSubmit:r,control:d,setValue:e}=A({resolver:se(a)}),f=J(),l=n.useRef(null),p=n.useRef(null),m=n.useRef(null),R=n.useRef(null),[u,K]=F(),[x,B]=n.useState(u.get("category")??""),[j,M]=n.useState(u.get("sex")??""),[S,k]=n.useState(u.get("species")??""),[E,h]=n.useState(!1),[$,C]=n.useState(!1),[G,y]=n.useState(!1),L=o=>{g(c=>({...c,...o})),T(o),f(V(1))},O=()=>{t==="Category"?h(!E):t==="By gender"?C(!$):y(!G)},N=o=>{const c={};t==="Category"?(B(o),c.category=o||void 0):t==="By gender"?(M(o),c.sex=o||void 0):(k(o),c.species=o||void 0),h(!1),C(!1),y(!1),T(c),r(L)()},T=o=>{const c=new URLSearchParams(u);Object.entries(o).forEach(([D,I])=>{I?c.set(D,I):c.delete(D)}),K(c)};return n.useEffect(()=>{B(u.get("category")??""),M(u.get("sex")??""),k(u.get("species")??"")},[u]),n.useEffect(()=>{e("category",x||""),e("sex",j||""),e("species",S||"")},[x,j,S,e]),s.jsx("form",{onSubmit:r(L),ref:l,className:"form",children:s.jsxs("div",{className:`find-form-wrap ${t==="Category"||t==="By gender"?"category":t==="By type"?"type":""}`,children:[s.jsx(Q,{name:t==="Category"?"category":t==="By gender"?"sex":"species",control:d,render:({field:o})=>s.jsx("input",{...o,className:`input ${i==="light"?"":"dark"} find-input`,placeholder:t,value:t==="Category"?x:t==="By gender"?j:S})}),s.jsx("button",{type:"button",className:"find-form-button",onClick:O,ref:t==="Category"?p:t==="By gender"?m:R,children:s.jsx("div",{className:"find-form-icon",children:s.jsx(q,{name:"chevron-down",className:"icon-search"})})}),E&&s.jsx(v,{onSelect:N,onClose:()=>h(!1),ref:p,data:oe}),$&&s.jsx(v,{onSelect:N,onClose:()=>C(!1),ref:m,data:ne}),G&&s.jsx(v,{onSelect:N,onClose:()=>y(!1),ref:R,data:te})]})})},re=({setSearchQuery:t})=>{const{theme:g}=b(),[a,i]=F(),r=a.get("sort"),d=e=>{const f=r===e?"":e;t(p=>({...p,sort:f}));const l=new URLSearchParams(a);f?l.set("sort",f):l.delete("sort"),i(l)};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:`notices-form-wrap ${g==="light"?"":"dark"}`,children:[s.jsxs("div",{className:"notices-form-top",children:[s.jsx(X,{setSearchQuery:t,placeholder:"Search"}),s.jsx(w,{setSearchQuery:t,placeholder:"Category"}),s.jsx(w,{setSearchQuery:t,placeholder:"By gender"}),s.jsx(w,{setSearchQuery:t,placeholder:"By type"})]}),s.jsx("div",{className:"notices-stroke"}),s.jsx("div",{className:"sort-button-wrap",children:["Popular","Unpopular","Cheap","Expensive"].map(e=>s.jsx(ae,{setSearchQuery:t,text:e,isActive:r===e.toLowerCase(),onClick:()=>d(e.toLowerCase())},e))})]})})},pe=()=>{const t=U(_),g=6,[a,i]=F();n.useEffect(()=>{a.has("page")||i({page:"1"})},[a,i]);const r=Number(a.get("page"))||1,d=U(z),[e,f]=n.useState({title:a.get("title")||null,category:a.get("category")||null,sex:a.get("sex")||null,species:a.get("species")||null,sort:a.get("sort")||null}),l=J();n.useEffect(()=>{const m={page:r,limit:g,title:e!=null&&e.title?e.title:null,category:e!=null&&e.category?e.category:null,sex:e!=null&&e.sex?e.sex:null,species:e!=null&&e.species?e.species:null,sort:e!=null&&e.sort?e==null?void 0:e.sort:null};l(H()),l(W(m))},[r,l,e]);const p=m=>{i({page:String(m),...e.title&&{title:String(e.title)},...e.category&&{category:String(e.category)},...e.sex&&{sex:String(e.sex)},...e.species&&{species:String(e.species)}})};return s.jsxs("div",{className:"notices-container",children:[s.jsxs("div",{className:"notices-main-wrap",children:[s.jsx("h2",{className:"notices-main-title",children:"Find your favorite pet"}),s.jsx(re,{setSearchQuery:f})]}),s.jsx("div",{className:"news-cards notices-cards",children:t&&t.length>0?t.map(m=>s.jsx(Z,{data:m},m._id)):s.jsx("p",{children:"There are news yet"})}),d&&s.jsx(Y,{totalItems:d,currentPage:r,onPageChange:p})]})};export{pe as default};
