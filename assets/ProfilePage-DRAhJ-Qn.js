import{i as v,k as w,m as M,a as k,r as m,n as U,o as E,j as e,L as P,I as g,p as q,q as S,t as R,v as I,u as $,w as A,B as L,x as O,y as B,z,M as F,A as G}from"./index-C4xMr_jA.js";import{N as V}from"./NoticeCard-CfwxwXOx.js";import{U as T}from"./UploadFotoForm-BPXjsbjW.js";import{u as Y}from"./index.esm-DC9Rd-eh.js";import{c as H,a as C,o as J}from"./index.esm-d2xcsFYg.js";import"./formatDate-Cl6MRW5r.js";const K=()=>{const t=v(w).favorites,l=v(M),n=1e3,r=k();return m.useEffect(()=>(r(U({page:1,limit:n,title:null,category:null,sex:null,species:null,sort:null})),()=>{r(E())}),[r]),e.jsx("div",{className:"favorites-wrap",children:t.length!==0?l==null?void 0:l.filter(a=>t.includes(a._id)).map(a=>e.jsx(V,{data:a},a._id)):e.jsx("div",{className:"favorites-no-pets",children:e.jsxs("p",{children:["Oops, ",e.jsx("span",{children:"looks like there aren't any furries"})," on our adorable page yet. Do not worry! View your pets on the"," ",e.jsx(P,{to:"/notices",className:"favorites-link",children:'"find your favorite pet"'})," ","page and add them to your favorites."]})})})},Q=({data:i})=>{const{sex:t,imgURL:l,title:n,name:r,birthday:a,species:f,_id:s}=i,[o,p]=m.useState(!1),x=v(M),h=k(),c=()=>{s&&(h(q(s)),h(S(s)))},N=()=>{o||(s&&h(R(s)),p(!0))},j=()=>{o&&(s&&h(S(s)),p(!1))};return m.useEffect(()=>{if(s){const d=x.find(y=>y._id===s);p(!!d)}},[x,s]),e.jsxs("div",{className:"my-pet-border",children:[e.jsxs("div",{className:"my-pet-wrapper",children:[l?e.jsx("img",{src:l.toString(),alt:n,className:"my-pet-img"}):e.jsx(g,{className:"icon-paw",name:"icon-paw"}),e.jsxs("div",{className:"my-pet-middle-part",children:[e.jsx("h3",{className:"my-pet-title",title:n,children:n}),e.jsxs("div",{className:"my-pet-text-wrapper",children:[e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Name"}),e.jsx("p",{className:"my-pet-notices-text",title:r,children:r})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Birthday"}),e.jsx("p",{children:a})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Sex"}),e.jsx("p",{children:t})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Species"}),e.jsx("p",{children:f})]})]})]})]}),e.jsx("div",{className:"my-pet-delete",onClick:c,children:e.jsx(g,{className:"icon-heart delete",name:"delete"})}),e.jsxs("div",{className:"my-pet-button-wrapper",children:[e.jsx("button",{type:"button",onClick:N,className:"form-button submit to-publish",children:o?e.jsxs(e.Fragment,{children:["Published ",e.jsx(g,{name:"icon-check",className:"icon-check"})]}):"To publish"}),e.jsx("button",{type:"button",onClick:j,className:"form-button back remove",children:"Remove from publication"})]})]})},W=()=>{const i=v(I);return e.jsx("section",{className:"my-pets-list",children:(i==null?void 0:i.length)!==0?i.map(t=>e.jsx(Q,{data:t},t._id)):e.jsx("p",{className:"favorites-no-pets my-pets",children:"No my pets yet :("})})},X=({onClose:i,userData:t})=>{var c,N,j;const l=k(),n=H({name:C(),email:C().email(),phone:C().matches(/^\d+$/,"The phone must contain only numbers.").length(9,"The phone must contain exactly 9 digits")}).required(),{theme:r}=$(),{register:a,handleSubmit:f,setValue:s,watch:o,reset:p,formState:{errors:x}}=Y({resolver:J(n),defaultValues:{name:t.name||"User name",email:t.email||"",phone:((c=t.phone)==null?void 0:c.toString())||""},mode:"onBlur"});m.useEffect(()=>{var d;s("name",t.name||"User name"),s("phone",((d=t.phone)==null?void 0:d.toString())||"")},[t,s]);const h=async d=>{const y={name:d.name,phone:d.phone};try{await l(A(y)),p(y),i(),L.success("Your data is successfully updated")}catch{L.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:f(h),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...a("name"),className:`input ${r==="light"?"":"dark"} edit`,value:o("name"),onChange:d=>s("name",d.target.value)}),e.jsx("p",{className:"form-errors",children:(N=x.name)==null?void 0:N.message})]}),e.jsx("div",{children:e.jsx("input",{...a("email"),className:`input ${r==="light"?"":"dark"} edit`,value:o("email"),readOnly:!0})}),e.jsxs("div",{children:[e.jsx("input",{...a("phone"),className:`input ${r==="light"?"":"dark"} edit`,value:o("phone"),onChange:d=>s("phone",d.target.value)}),e.jsx("p",{className:"form-errors",children:(j=x.phone)==null?void 0:j.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},Z=m.forwardRef(({userData:i,onClose:t,onChange:l},n)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:i.avatar?i.avatar:O,alt:i.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx(T,{onChange:l,ref:n,isModal:!0})}),e.jsx(X,{onClose:t,userData:i})]})),D=()=>{const i=v(w),{theme:t}=$(),{name:l,email:n,phone:r}=i,f=(s=>{const o=s==null?void 0:s.toString();if(o)return o==null?void 0:o.replace(/(\d{2})(\d{3})(\d{2})(\d{2})/,"$1 $2 $3 $4")})(r);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:l||"User name",className:`input profile ${t==="light"?"":"dark"}`,readOnly:!0}),e.jsx("input",{type:"email",value:n??"email",className:`input profile ${t==="light"?"":"dark"}`,readOnly:!0}),e.jsx("input",{type:"tel",value:`+380 ${f}`,className:`input profile ${t==="light"?"":"dark"}`,readOnly:!0})]})]})},ee=()=>{const t=v(w).viewed,l=v(M),n=1e3,r=k();return m.useEffect(()=>(r(U({page:1,limit:n,title:null,category:null,sex:null,species:null,sort:null})),()=>{r(E())}),[r]),e.jsx("div",{className:"favorites-wrap",children:t.length!==0?l==null?void 0:l.filter(a=>t.includes(a._id)).map(a=>e.jsx(V,{data:a},a._id)):e.jsx("div",{className:"favorites-no-pets",children:e.jsxs("p",{children:["Oops, ",e.jsx("span",{children:"looks like there aren't any viewed furries"})," on our adorable page yet. Do not worry! View your pets on the"," ",e.jsx(P,{to:"/notices",className:"favorites-link",children:'"find your favorite pet"'})," ","page and add them to your favorites."]})})})},ne=()=>{const{theme:i}=$(),[t,l]=m.useState(!1),[n,r]=m.useState(!1),[a,f]=m.useState(),[s,o]=m.useState(!0),[p,x]=m.useState(!1),h=m.useRef(null),c=v(w),N=k(),j=u=>{u==="open"?(r(!0),document.body.classList.add("body-scroll-lock")):(r(!1),document.body.classList.remove("body-scroll-lock"))},d=u=>{u==="open"?(l(!0),document.body.classList.add("body-scroll-lock")):(l(!1),document.body.classList.remove("body-scroll-lock"))},y=u=>{if(u instanceof File)f(u);else{const b=u.target.files;if(b&&b.length>0){const _=b[0];f(_)}}};return m.useEffect(()=>{a&&(N(B(a)),h.current&&(h.current.value=""))},[a,N]),e.jsxs("div",{children:[!c&&e.jsx(z,{}),c&&e.jsxs("div",{className:"profile-main-wrap",children:[e.jsxs("div",{className:`profile-background my ${i==="light"?"":"dark"}`,children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap name",children:[e.jsx("p",{className:"profile-name",children:c.name}),e.jsx(g,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>j("open"),children:e.jsx(g,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:c!=null&&c.avatar?`${c.avatar}`:O,alt:c.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx(T,{onChange:y,ref:h,isModal:!1})}),e.jsx(D,{}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs(P,{to:"/add-pet",className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(g,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(W,{}),e.jsx("button",{type:"button",onClick:u=>{u.stopPropagation(),d("open")},className:"menu-link register",children:e.jsx("p",{className:"menu-logout",children:"Log out"})})]}),e.jsxs("div",{className:"profile-right-part",children:[e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${s&&!p||!s&&!p?"":"unactive"} ${i==="light"?"":"dark"}`,onClick:()=>{o(!0),x(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${p&&!s?"":"unactive"} ${i==="light"?"":"dark"}`,onClick:()=>{x(!0),o(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background favorite",children:[s&&!p&&e.jsx(K,{}),p&&!s&&e.jsx(ee,{})]})]}),t&&e.jsx(F,{onClose:()=>d("close"),children:e.jsx(G,{userData:c,onClose:()=>d("close")})}),n&&e.jsx(F,{onClose:()=>j("close"),children:e.jsx(Z,{userData:c,onClose:()=>j("close"),onChange:y})})]})]})};export{ne as default};
