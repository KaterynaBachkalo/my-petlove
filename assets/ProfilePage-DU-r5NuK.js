import{e as g,s as F,f as S,u as y,r as n,g as P,j as e,h as O,B as b,i as M,k as $,m as U,I as v,M as C,n as V}from"./index-B28fu7bo.js";import{N as q}from"./NoticeCard-CTcTJBFS.js";import{u as I}from"./index.esm-D4fcn2yF.js";import{c as R,a as k,d as A,o as T}from"./index.esm-D2jwpODB.js";import"./formatDate-Cl6MRW5r.js";const _=()=>{const s=g(F).favorites,t=g(S),i=6,c=y();return n.useEffect(()=>{c(P({page:1,limit:i,title:null,category:null,sex:null,species:null,sort:null}))},[c]),e.jsx("div",{className:"favorites-wrap",children:s.length!==0?t==null?void 0:t.filter(m=>s.includes(m._id)).map(m=>e.jsx(q,{data:m},m._id)):e.jsx("p",{className:"favorites-no-pets",children:"No favorite pets yet :("})})},B=()=>e.jsx("section",{className:"my-pets-list",children:e.jsx("p",{className:"favorites-no-pets",children:"No my pets yet :("})}),L=n.forwardRef(({onChange:a},s)=>{const t=i=>{a(i)};return e.jsxs("form",{children:[e.jsx("input",{id:"inputFile",type:"file",onChange:t,className:"inputFile",ref:s}),e.jsx("label",{htmlFor:"inputFile",className:"uploadPhoto",children:e.jsx("p",{className:"profile-upload",children:"Upload photo"})})]})}),G=({onClose:a,userData:s})=>{var h,l,f;const t=y(),i=R({name:k(),email:k().email().required("Email is required"),phone:A()}).required(),{register:c,handleSubmit:m,setValue:r,watch:u,formState:{errors:d}}=I({resolver:T(i),defaultValues:{name:s.name||"",email:s.email||"",phone:s.phone||0}});n.useEffect(()=>{r("name",s.name||""),r("email",s.email||""),r("phone",s.phone||0)},[s,r]);const x=async o=>{try{if(await t(O(o)),a(),d)return b.error("Something went wrong...")}catch{b.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:m(x),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...c("name"),className:"input",value:u("name"),onChange:o=>r("name",o.target.value)}),e.jsx("p",{className:"form-errors",children:(h=d.name)==null?void 0:h.message})]}),e.jsxs("div",{children:[e.jsx("input",{...c("email"),className:"input",value:u("email"),onChange:o=>r("email",o.target.value)}),e.jsx("p",{className:"form-errors",children:(l=d.email)==null?void 0:l.message})]}),e.jsxs("div",{children:[e.jsx("input",{...c("phone"),className:"input",value:u("phone"),onChange:o=>r("phone",Number(o.target.value))}),e.jsx("p",{className:"form-errors",children:(f=d.phone)==null?void 0:f.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},W=n.forwardRef(({userData:a,onClose:s,onChange:t},i)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:a.avatar?a.avatar.startsWith("http")?a.avatar:`undefined${a.avatar}`:M,alt:a.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(L,{onChange:t,ref:i})]}),e.jsx(G,{onClose:s,userData:a})]})),z=({userData:a})=>{const{name:s,email:t,phone:i}=a;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:s??"NONAME",className:"input profile",readOnly:!0}),e.jsx("input",{type:"email",value:t??"email",className:"input profile",readOnly:!0}),e.jsx("input",{type:"tel",value:i??"+380",className:"input profile",readOnly:!0})]})]})},H=()=>e.jsx("div",{children:"ViewedList"}),Z=()=>{const[a,s]=n.useState(!1),[t,i]=n.useState(!1),[c,m]=n.useState(),[r,u]=n.useState(!0),[d,x]=n.useState(!1),h=n.useRef(null),l=g(F),f=y(),o=p=>{p==="open"?(i(!0),document.body.classList.add("body-scroll-lock")):(i(!1),document.body.classList.remove("body-scroll-lock"))},j=p=>{p==="open"?(s(!0),document.body.classList.add("body-scroll-lock")):(s(!1),document.body.classList.remove("body-scroll-lock"))},w=p=>{const N=p.target.files;if(N&&N.length>0){const E=N[0];m(E)}};return n.useEffect(()=>{c&&(f($(c)),h.current&&(h.current.value=""))},[c,f]),e.jsxs("div",{children:[!l&&e.jsx(U,{}),l&&e.jsxs("div",{className:"profile-main-wrap",children:[e.jsxs("div",{className:"profile-background my",children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:l.name}),e.jsx(v,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>o("open"),children:e.jsx(v,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:l!=null&&l.avatar?`${l.avatar}`:M,alt:l.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(L,{onChange:w,ref:h})]}),e.jsx(z,{userData:l}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs("div",{className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(v,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(B,{}),e.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),j("open")},className:"menu-link register",children:e.jsx("p",{className:"menu-logout",children:"Log out"})})]}),e.jsxs("div",{className:"profile-right-part",children:[e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${r&&!d||!r&&!d?"":"unactive"}`,onClick:()=>{u(!0),x(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${d&&!r?"":"unactive"}`,onClick:()=>{x(!0),u(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background",children:[r&&!d&&e.jsx(_,{}),d&&!r&&e.jsx(H,{})]})]}),a&&e.jsx(C,{onClose:()=>j("close"),children:e.jsx(V,{userData:l,onClose:()=>j("close")})}),t&&e.jsx(C,{onClose:()=>o("close"),children:e.jsx(W,{userData:l,onClose:()=>o("close"),onChange:w})})]})]})};export{Z as default};
