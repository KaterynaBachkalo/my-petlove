import{e as N,s as b,f as E,u as v,r as d,g as F,j as e,I as j,h as O,i as U,k as V,B as w,m as L,n as $,o as I,L as R,M as C,p as A}from"./index-D6TZNNxK.js";import{N as _}from"./NoticeCard-GF9rihAX.js";import{U as S}from"./UploadFotoForm-DWzCQ0cB.js";import{u as q}from"./index.esm-CoSe3K7M.js";import{c as B,a as M,d as T,o as G}from"./index.esm-DpK4bxu6.js";import"./formatDate-Cl6MRW5r.js";const Y=()=>{const s=N(b).favorites,t=N(E),n=6,r=v();return d.useEffect(()=>{r(F({page:1,limit:n,title:null,category:null,sex:null,species:null,sort:null}))},[r]),e.jsx("div",{className:"favorites-wrap",children:s.length!==0?t==null?void 0:t.filter(o=>s.includes(o._id)).map(o=>e.jsx(_,{data:o},o._id)):e.jsx("p",{className:"favorites-no-pets",children:"No favorite pets yet :("})})},z=({data:a})=>{const{sex:s,imgURL:t,title:n,name:r,birthday:o,species:i,_id:m}=a,c=v(),h=()=>{m&&c(O(m))};return e.jsxs("div",{className:"notices-card profile",children:[e.jsxs("div",{className:"notices-card-top",children:[t?e.jsx("img",{src:t.toString(),alt:n,className:"notices-img"}):e.jsx(j,{className:"icon-paw",name:"icon-paw"}),e.jsxs("div",{className:"notices-text-wrapper",children:[e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Name"}),e.jsx("p",{children:r})]}),e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Birthday"}),e.jsx("p",{children:o})]}),e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Sex"}),e.jsx("p",{children:s})]}),e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Species"}),e.jsx("p",{children:i})]})]})]}),e.jsx("div",{className:"notices-button-wrap",children:e.jsx("div",{className:"notices-add-favorite",onClick:h,children:e.jsx(j,{className:"icon-heart",name:"delete"})})})]})},H=()=>{const a=N(U);return e.jsx("section",{className:"my-pets-list",children:(a==null?void 0:a.length)!==0?a.map(s=>e.jsx(z,{data:s},s._id)):e.jsx("p",{className:"favorites-no-pets",children:"No my pets yet :("})})},J=({onClose:a,userData:s})=>{var x,l;const t=v(),n=B({name:M(),email:M().email(),phone:T()}).required(),{register:r,handleSubmit:o,setValue:i,watch:m,formState:{errors:c}}=q({resolver:G(n),defaultValues:{name:s.name||"",email:s.email||"",phone:s.phone||0}});d.useEffect(()=>{i("name",s.name||""),i("phone",s.phone||0)},[s,i]);const h=async p=>{const f={name:p.name,phone:p.phone};try{if(await t(V(f)),a(),Object.keys(c).length!==0)return w.error("Something went wrong...");w.success("Your data is successfully updated")}catch{w.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:o(h),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...r("name"),className:"input edit",value:m("name"),onChange:p=>i("name",p.target.value)}),e.jsx("p",{className:"form-errors",children:(x=c.name)==null?void 0:x.message})]}),e.jsx("div",{children:e.jsx("input",{...r("email"),className:"input edit",value:m("email"),readOnly:!0})}),e.jsxs("div",{children:[e.jsx("input",{...r("phone"),className:"input edit",value:m("phone"),onChange:p=>i("phone",Number(p.target.value))}),e.jsx("p",{className:"form-errors",children:(l=c.phone)==null?void 0:l.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},K=d.forwardRef(({userData:a,onClose:s,onChange:t},n)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:a.avatar?a.avatar:L,alt:a.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(S,{onChange:t,ref:n,isModal:!0})]}),e.jsx(J,{onClose:s,userData:a})]})),Q=()=>{const a=N(b),{name:s,email:t,phone:n}=a;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:s??"NONAME",className:"input profile",readOnly:!0}),e.jsx("input",{type:"email",value:t??"email",className:"input profile",readOnly:!0}),e.jsx("input",{type:"tel",value:n??"+380",className:"input profile",readOnly:!0})]})]})},W=()=>e.jsx("div",{children:"ViewedList"}),te=()=>{const[a,s]=d.useState(!1),[t,n]=d.useState(!1),[r,o]=d.useState(),[i,m]=d.useState(!0),[c,h]=d.useState(!1),x=d.useRef(null),l=N(b),p=v(),f=u=>{u==="open"?(n(!0),document.body.classList.add("body-scroll-lock")):(n(!1),document.body.classList.remove("body-scroll-lock"))},g=u=>{u==="open"?(s(!0),document.body.classList.add("body-scroll-lock")):(s(!1),document.body.classList.remove("body-scroll-lock"))},k=u=>{const y=u.target.files;if(y&&y.length>0){const P=y[0];o(P)}};return d.useEffect(()=>{r&&(p($(r)),x.current&&(x.current.value=""))},[r,p]),e.jsxs("div",{children:[!l&&e.jsx(I,{}),l&&e.jsxs("div",{className:"profile-main-wrap",children:[e.jsxs("div",{className:"profile-background my",children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:l.name}),e.jsx(j,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>f("open"),children:e.jsx(j,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:l!=null&&l.avatar?`${l.avatar}`:L,alt:l.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(S,{onChange:k,ref:x,isModal:!1})]}),e.jsx(Q,{}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs(R,{to:"/add-pet",className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(j,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(H,{}),e.jsx("button",{type:"button",onClick:u=>{u.stopPropagation(),g("open")},className:"menu-link register",children:e.jsx("p",{className:"menu-logout",children:"Log out"})})]}),e.jsxs("div",{className:"profile-right-part",children:[e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${i&&!c||!i&&!c?"":"unactive"}`,onClick:()=>{m(!0),h(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${c&&!i?"":"unactive"}`,onClick:()=>{h(!0),m(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background",children:[i&&!c&&e.jsx(Y,{}),c&&!i&&e.jsx(W,{})]})]}),a&&e.jsx(C,{onClose:()=>g("close"),children:e.jsx(A,{userData:l,onClose:()=>g("close")})}),t&&e.jsx(C,{onClose:()=>f("close"),children:e.jsx(K,{userData:l,onClose:()=>f("close"),onChange:k})})]})]})};export{te as default};
