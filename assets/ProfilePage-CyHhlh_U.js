import{e as N,s as F,f as E,u as y,r as i,g as P,h as $,j as e,d as O,i as U,B as b,k as M,I as v,M as C,m as V,n as A,o as q}from"./index-DARQtDB5.js";import{N as I}from"./NoticeCard-BlCkwj9B.js";import{u as R}from"./index.esm-8SFayVmx.js";import{c as T,a as k,d as _,o as B}from"./index.esm-7EkQI8U-.js";import"./formatDate-Cl6MRW5r.js";const G=()=>{const s=N(F).favorites,l=N(E),t=6,d=y();return i.useEffect(()=>(d(P({page:1,limit:t,title:null,category:null,sex:null,species:null,sort:null})),()=>{d($())}),[d]),e.jsx(e.Fragment,{children:s.length!==0?l==null?void 0:l.filter(o=>s.includes(o._id)).map(o=>e.jsx(I,{data:o},o._id)):e.jsx("p",{className:"favorites-no-pets",children:"No favorite pets yet :("})})},W=()=>e.jsx("section",{className:"my-pets-list",children:e.jsx("p",{className:"favorites-no-pets",children:"No my pets yet :("})}),z=({onClose:a,userData:s})=>{var r,f,x;const l=y(),t=O(),d=T({name:k(),email:k().email().required("Email is required"),phone:_()}).required(),{register:o,handleSubmit:u,setValue:c,watch:m,formState:{errors:h}}=R({resolver:B(d),defaultValues:{name:s.name||"",email:s.email||"",phone:s.phone||0}});i.useEffect(()=>{c("name",s.name||""),c("email",s.email||""),c("phone",s.phone||0)},[s,c]);const g=async n=>{try{if(await l(U(n)),t("/profile"),a(),h)return b.error("Something went wrong...")}catch{b.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:u(g),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...o("name"),className:"input",value:m("name"),onChange:n=>c("name",n.target.value)}),e.jsx("p",{className:"form-errors",children:(r=h.name)==null?void 0:r.message})]}),e.jsxs("div",{children:[e.jsx("input",{...o("email"),className:"input",value:m("email"),onChange:n=>c("email",n.target.value)}),e.jsx("p",{className:"form-errors",children:(f=h.email)==null?void 0:f.message})]}),e.jsxs("div",{children:[e.jsx("input",{...o("phone"),className:"input",value:m("phone"),onChange:n=>c("phone",Number(n.target.value))}),e.jsx("p",{className:"form-errors",children:(x=h.phone)==null?void 0:x.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},L=i.forwardRef(({onChange:a},s)=>{const l=t=>{t.preventDefault(),a(t)};return e.jsxs("form",{onSubmit:t=>t.preventDefault(),children:[e.jsx("input",{id:"inputFile",type:"file",onChange:l,className:"inputFile",ref:s}),e.jsx("label",{htmlFor:"inputFile",className:"uploadPhoto",children:e.jsx("p",{className:"profile-upload",children:"Upload photo"})})]})}),H=i.forwardRef(({userData:a,onClose:s,onChange:l},t)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:a.avatar?a.avatar.startsWith("http")?a.avatar:`undefined${a.avatar}`:M,alt:a.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(L,{onChange:l,ref:t})]}),e.jsx(z,{onClose:s,userData:a})]})),J=({userData:a})=>{const{name:s,email:l,phone:t}=a;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:s??"NONAME",className:"input",readOnly:!0}),e.jsx("input",{type:"email",value:l??"email",className:"input",readOnly:!0}),e.jsx("input",{type:"tel",value:t??"+380",className:"input",readOnly:!0})]})]})},K=()=>e.jsx("div",{children:"ViewedList"}),ee=()=>{const[a,s]=i.useState(!1),[l,t]=i.useState(!1),[d,o]=i.useState(),[u,c]=i.useState(!0),[m,h]=i.useState(!1),g=i.useRef(null),r=N(F),f=y(),x=p=>{p==="open"?(t(!0),document.body.classList.add("body-scroll-lock")):(t(!1),document.body.classList.remove("body-scroll-lock"))},n=p=>{p==="open"?(s(!0),document.body.classList.add("body-scroll-lock")):(s(!1),document.body.classList.remove("body-scroll-lock"))},w=p=>{const j=p.target.files;if(j&&j.length>0){const S=j[0];o(S)}};return i.useEffect(()=>{(async()=>{if(d)try{await f(A(d)).unwrap(),f(q())}catch(j){console.error("Failed to update avatar:",j)}})()},[d,f]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"profile-background my",children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:r.name}),e.jsx(v,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>x("open"),children:e.jsx(v,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsxs("div",{className:"img-wrap card-info-modal profile",children:[e.jsx("img",{src:r!=null&&r.avatar?`undefined${r.avatar}`:M,alt:r.name??"User avatar",className:"card-info-modal-img logout profile"}),e.jsx(L,{onChange:w,ref:g})]}),e.jsx(J,{userData:r}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs("div",{className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(v,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(W,{}),e.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),n("open")},className:"menu-link register",children:e.jsx("p",{className:"menu-logout",children:"Log out"})})]}),e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${u&&!m||!u&&!m?"":"unactive"}`,onClick:()=>{c(!0),h(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${m&&!u?"":"unactive"}`,onClick:()=>{h(!0),c(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background",children:[u&&!m&&e.jsx(G,{}),m&&!u&&e.jsx(K,{})]}),a&&e.jsx(C,{onClose:()=>n("close"),children:e.jsx(V,{userData:r,onClose:()=>n("close")})}),l&&e.jsx(C,{onClose:()=>x("close"),children:e.jsx(H,{userData:r,onClose:()=>x("close"),onChange:w})})]})};export{ee as default};
