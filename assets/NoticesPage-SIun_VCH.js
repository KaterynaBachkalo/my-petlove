import{j as s,I as U,u as q,r as o,y as b,E as V,g as T,i as _,F as z,m as H,k as J}from"./index-CTbu2FOC.js";import{F as K,P as W}from"./FindForm-DTwsgPkl.js";import{N as X}from"./NoticeCard-0FT9enpf.js";import{u as Y,C as Z}from"./index.esm-B5nzorOR.js";import{c as A,a as P,o as Q}from"./index.esm-H8jkYDyc.js";import{M as v,t as ee}from"./types-C4guQBFT.js";import"./formatDate-Cl6MRW5r.js";const se=({setSearchQuery:t,text:l,isActive:n,onClick:c})=>{const m=()=>{t(a=>({...a,sort:n?"":l})),c()};return s.jsx("div",{className:"button-wrap",children:s.jsxs("button",{type:"submit",className:`sort-button ${n?"cross":""}`,onClick:m,children:[l,n&&s.jsx(U,{className:"icon-cross",name:"close"})]})})},te=["unknown","female","male","multiple"],ae=["sell","free","lost","found"],w=({placeholder:t,setSearchQuery:l})=>{const n=A({category:P(),sex:P(),species:P()}).required(),{handleSubmit:c,control:m,setValue:a}=Y({resolver:Q(n)}),e=q(),f=o.useRef(null),d=o.useRef(null),p=o.useRef(null),g=o.useRef(null),[u,D]=b(),[x,F]=o.useState(u.get("category")??""),[j,R]=o.useState(u.get("sex")??""),[S,B]=o.useState(u.get("species")??""),[M,C]=o.useState(!1),[E,y]=o.useState(!1),[k,N]=o.useState(!1),G=r=>{l(i=>({...i,...r})),L(r),e(V(1))},O=()=>{t==="Category"?C(!M):t==="By gender"?y(!E):N(!k)},h=r=>{const i={};t==="Category"?(F(r),i.category=r||void 0):t==="By gender"?(R(r),i.sex=r||void 0):(B(r),i.species=r||void 0),C(!1),y(!1),N(!1),L(i),c(G)()},L=r=>{const i=new URLSearchParams(u);Object.entries(r).forEach(([$,I])=>{I?i.set($,I):i.delete($)}),D(i)};return o.useEffect(()=>{F(u.get("category")??""),R(u.get("sex")??""),B(u.get("species")??"")},[u]),o.useEffect(()=>{a("category",x||""),a("sex",j||""),a("species",S||"")},[x,j,S,a]),s.jsx("form",{onSubmit:c(G),ref:f,className:"form",children:s.jsxs("div",{className:`find-form-wrap ${t==="Category"||t==="By gender"?"category":t==="By type"?"type":""}`,children:[s.jsx(Z,{name:t==="Category"?"category":t==="By gender"?"sex":"species",control:m,render:({field:r})=>s.jsx("input",{...r,className:"input find-input",placeholder:t,value:t==="Category"?x:t==="By gender"?j:S})}),s.jsx("button",{type:"button",className:"find-form-button",onClick:O,ref:t==="Category"?d:t==="By gender"?p:g,children:s.jsx("div",{className:"find-form-icon",children:s.jsx(U,{name:"chevron-down",className:"icon-search"})})}),M&&s.jsx(v,{onSelect:h,onClose:()=>C(!1),ref:d,data:ae}),E&&s.jsx(v,{onSelect:h,onClose:()=>y(!1),ref:p,data:te}),k&&s.jsx(v,{onSelect:h,onClose:()=>N(!1),ref:g,data:ee})]})})},ne=({setSearchQuery:t})=>{const[l,n]=b(),c=l.get("sort"),m=a=>{const e=c===a?"":a;t(d=>({...d,sort:e}));const f=new URLSearchParams(l);e?f.set("sort",e):f.delete("sort"),n(f)};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"notices-form-wrap",children:[s.jsxs("div",{className:"notices-form-top",children:[s.jsx(K,{setSearchQuery:t,placeholder:"Search"}),s.jsx(w,{setSearchQuery:t,placeholder:"Category"}),s.jsx(w,{setSearchQuery:t,placeholder:"By gender"}),s.jsx(w,{setSearchQuery:t,placeholder:"By type"})]}),s.jsx("div",{className:"notices-stroke"}),s.jsx("div",{className:"sort-button-wrap",children:["Popular","Unpopular","Cheap","Expensive"].map(a=>s.jsx(se,{setSearchQuery:t,text:a,isActive:c===a.toLowerCase(),onClick:()=>m(a.toLowerCase())},a))})]})})},de=()=>{const t=T(_),l=6,[n,c]=b();o.useEffect(()=>{n.has("page")||c({page:"1"})},[n,c]);const m=Number(n.get("page"))||1,a=T(z),[e,f]=o.useState({title:n.get("title")||null,category:n.get("category")||null,sex:n.get("sex")||null,species:n.get("species")||null,sort:n.get("sort")||null}),d=q();o.useEffect(()=>{const g={page:m,limit:l,title:e!=null&&e.title?e.title:null,category:e!=null&&e.category?e.category:null,sex:e!=null&&e.sex?e.sex:null,species:e!=null&&e.species?e.species:null,sort:e!=null&&e.sort?e==null?void 0:e.sort:null};d(H()),d(J(g))},[m,d,e]);const p=g=>{c({page:String(g),...e.title&&{title:String(e.title)},...e.category&&{category:String(e.category)},...e.sex&&{sex:String(e.sex)},...e.species&&{species:String(e.species)}})};return s.jsxs("div",{className:"notices-container",children:[s.jsxs("div",{className:"notices-main-wrap",children:[s.jsx("h2",{className:"notices-main-title",children:"Find your favorite pet"}),s.jsx(ne,{setSearchQuery:f})]}),s.jsx("div",{className:"news-cards notices-cards",children:t&&t.length>0?t.map(g=>s.jsx(X,{data:g},g._id)):s.jsx("p",{children:"There are news yet"})}),a&&s.jsx(W,{totalItems:a,currentPage:m,onPageChange:p})]})};export{de as default};
