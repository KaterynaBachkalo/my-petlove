import{e as y,s as k,f as U,u as g,r as m,g as $,h as E,j as e,L,I as v,i as O,k as V,m as I,B as C,n as S,o as R,p as q,M,q as T}from"./index-DoziOfyJ.js";import{N as _}from"./NoticeCard-B2F-dEYd.js";import{U as P}from"./UploadFotoForm-D94Au-HM.js";import{u as A}from"./index.esm-CVND3_uw.js";import{c as B,a as b,o as G}from"./index.esm-T-8WkfIw.js";import"./formatDate-Cl6MRW5r.js";const Y=()=>{const s=y(k).favorites,l=y(U),n=1e3,i=g();return m.useEffect(()=>(i($({page:1,limit:n,title:null,category:null,sex:null,species:null,sort:null})),()=>{i(E())}),[i]),e.jsx("div",{className:"favorites-wrap",children:s.length!==0?l==null?void 0:l.filter(r=>s.includes(r._id)).map(r=>e.jsx(_,{data:r},r._id)):e.jsx("div",{className:"favorites-no-pets",children:e.jsxs("p",{children:["Oops, ",e.jsx("span",{children:"looks like there aren't any furries"})," on our adorable page yet. Do not worry! View your pets on the"," ",e.jsx(L,{to:"/notices",className:"favorites-link",children:'"find your favorite pet"'})," ","page and add them to your favorites."]})})})},z=({data:a})=>{const{sex:s,imgURL:l,title:n,name:i,birthday:r,species:t,_id:o}=a,p=g(),u=()=>{o&&p(O(o))};return e.jsxs("div",{className:"my-pet-border",children:[e.jsxs("div",{className:"my-pet-wrapper",children:[l?e.jsx("img",{src:l.toString(),alt:n,className:"my-pet-img"}):e.jsx(v,{className:"icon-paw",name:"icon-paw"}),e.jsxs("div",{children:[e.jsx("h3",{className:"my-pet-title",title:n,children:n}),e.jsxs("div",{className:"my-pet-text-wrapper",children:[e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Name"}),e.jsx("p",{className:"my-pet-notices-text",title:i,children:i})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Birthday"}),e.jsx("p",{children:r})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Sex"}),e.jsx("p",{children:s})]}),e.jsxs("div",{className:"notices-text-wrap my-pet",children:[e.jsx("p",{className:"notices-title-text",children:"Species"}),e.jsx("p",{children:t})]})]})]})]}),e.jsx("div",{className:"my-pet-delete",onClick:u,children:e.jsx(v,{className:"icon-heart delete",name:"delete"})})]})},H=()=>{const a=y(V);return e.jsx("section",{className:"my-pets-list",children:(a==null?void 0:a.length)!==0?a.map(s=>e.jsx(z,{data:s},s._id)):e.jsx("p",{className:"favorites-no-pets",children:"No my pets yet :("})})},J=({onClose:a,userData:s})=>{var c,j,x;const l=g(),n=B({name:b(),email:b().email(),phone:b().matches(/^\d+$/,"The phone must contain only numbers.").length(9,"The phone must contain exactly 9 digits")}).required(),{register:i,handleSubmit:r,setValue:t,watch:o,reset:p,formState:{errors:u}}=A({resolver:G(n),defaultValues:{name:s.name||"User name",email:s.email||"",phone:((c=s.phone)==null?void 0:c.toString())||""},mode:"onBlur"});m.useEffect(()=>{var d;t("name",s.name||"User name"),t("phone",((d=s.phone)==null?void 0:d.toString())||"")},[s,t]);const f=async d=>{const N={name:d.name,phone:d.phone};try{await l(I(N)),p(N),a(),C.success("Your data is successfully updated")}catch{C.error("Something went wrong, please try again.")}};return e.jsxs("form",{onSubmit:r(f),children:[e.jsxs("div",{className:"wrap-input",children:[e.jsxs("div",{children:[e.jsx("input",{...i("name"),className:"input edit",value:o("name"),onChange:d=>t("name",d.target.value)}),e.jsx("p",{className:"form-errors",children:(j=u.name)==null?void 0:j.message})]}),e.jsx("div",{children:e.jsx("input",{...i("email"),className:"input edit",value:o("email"),readOnly:!0})}),e.jsxs("div",{children:[e.jsx("input",{...i("phone"),className:"input edit",value:o("phone"),onChange:d=>t("phone",d.target.value)}),e.jsx("p",{className:"form-errors",children:(x=u.phone)==null?void 0:x.message})]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Go to profile"})]})},K=m.forwardRef(({userData:a,onClose:s,onChange:l},n)=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"Edit information"}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:a.avatar?a.avatar:S,alt:a.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx(P,{onChange:l,ref:n,isModal:!0})}),e.jsx(J,{onClose:s,userData:a})]})),Q=()=>{const a=y(k),{name:s,email:l,phone:n}=a,r=(t=>{const o=t==null?void 0:t.toString();if(o)return o==null?void 0:o.replace(/(\d{2})(\d{3})(\d{2})(\d{2})/,"$1 $2 $3 $4")})(n);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"profile-title",children:"My information"}),e.jsxs("form",{className:"wrap-input profile",children:[e.jsx("input",{type:"text",value:s||"User name",className:"input profile",readOnly:!0}),e.jsx("input",{type:"email",value:l??"email",className:"input profile",readOnly:!0}),e.jsx("input",{type:"tel",value:`+380 ${r}`,className:"input profile",readOnly:!0})]})]})},W=()=>e.jsx("div",{children:"ViewedList"}),te=()=>{const[a,s]=m.useState(!1),[l,n]=m.useState(!1),[i,r]=m.useState(),[t,o]=m.useState(!0),[p,u]=m.useState(!1),f=m.useRef(null),c=y(k),j=g(),x=h=>{h==="open"?(n(!0),document.body.classList.add("body-scroll-lock")):(n(!1),document.body.classList.remove("body-scroll-lock"))},d=h=>{h==="open"?(s(!0),document.body.classList.add("body-scroll-lock")):(s(!1),document.body.classList.remove("body-scroll-lock"))},N=h=>{if(h instanceof File)r(h);else{const w=h.target.files;if(w&&w.length>0){const F=w[0];r(F)}}};return m.useEffect(()=>{i&&(j(R(i)),f.current&&(f.current.value=""))},[i,j]),e.jsxs("div",{children:[!c&&e.jsx(q,{}),c&&e.jsxs("div",{className:"profile-main-wrap",children:[e.jsxs("div",{className:"profile-background my",children:[e.jsxs("div",{className:"profile-user-wrapper",children:[e.jsxs("div",{className:"profile-user-wrap name",children:[e.jsx("p",{className:"profile-name",children:c.name}),e.jsx(v,{name:"icon-person",width:18,height:18,className:"icon-person"})]}),e.jsx("button",{type:"button",className:"profile-edit",onClick:()=>x("open"),children:e.jsx(v,{name:"edit",width:18,height:18,className:"profile-edit-icon"})})]}),e.jsx("div",{className:"pet-avatar",children:e.jsx("img",{src:c!=null&&c.avatar?`${c.avatar}`:S,alt:c.name??"User avatar",className:"card-info-modal-img logout profile"})}),e.jsx("div",{className:"img-wrap card-info-modal profile",children:e.jsx(P,{onChange:N,ref:f,isModal:!1})}),e.jsx(Q,{}),e.jsxs("div",{className:"profile-user-wrapper addPet",children:[e.jsx("h3",{className:"profile-title",children:"My pets"}),e.jsxs(L,{to:"/add-pet",className:"profile-user-wrap",children:[e.jsx("p",{className:"profile-name",children:"Add pet"}),e.jsx(v,{name:"icon-plus",width:18,height:18,className:"icon-plus"})]})]}),e.jsx(H,{}),e.jsx("button",{type:"button",onClick:h=>{h.stopPropagation(),d("open")},className:"menu-link register",children:e.jsx("p",{className:"menu-logout",children:"Log out"})})]}),e.jsxs("div",{className:"profile-right-part",children:[e.jsxs("div",{className:"profile-tab",children:[e.jsx("div",{className:`profile-user-wrap my-pets ${t&&!p||!t&&!p?"":"unactive"}`,onClick:()=>{o(!0),u(!1)},children:e.jsx("p",{className:"profile-name",children:"My favorite pets"})}),e.jsx("div",{className:`profile-user-wrap my-pets ${p&&!t?"":"unactive"}`,onClick:()=>{u(!0),o(!1)},children:e.jsx("p",{className:"profile-name",children:"Viewed"})})]}),e.jsxs("div",{className:"profile-background favorite",children:[t&&!p&&e.jsx(Y,{}),p&&!t&&e.jsx(W,{})]})]}),a&&e.jsx(M,{onClose:()=>d("close"),children:e.jsx(T,{userData:c,onClose:()=>d("close")})}),l&&e.jsx(M,{onClose:()=>x("close"),children:e.jsx(K,{userData:c,onClose:()=>x("close"),onChange:N})})]})]})};export{te as default};
